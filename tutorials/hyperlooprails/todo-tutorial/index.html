<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="google-site-verification" content="qjqVOvRhHfsuDbLOvaAnj2mkUZJ9Xwzg84TMVXduvUc" />

    <meta charset="UTF-8">
    <title>Hyperloop</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>


    <!-- Opal and Hyperloop -->
    <script src="http://cdn.opalrb.org/opal/current/opal.min.js"></script>
    <script src="https://rawgit.com/ruby-hyperloop/hyperloop-js/master/dist/opal.min.js"></script>
    <script src="https://rawgit.com/ruby-hyperloop/hyperloop-js/master/dist/hyperloop.min.js"></script>
    <script src="https://rawgit.com/ruby-hyperloop/hyperloop-js/master/dist/hyperloop-compiler.min.js"></script>


    <!-- If you want local copies... -->
    <!-- <script src="../../../javascripts/opal-compiler.js"></script> -->
    <!-- <script src="../../../javascripts/hyperloop.js"></script> -->

    <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>

    <script src="../../../javascripts/bootstrap.min.js"></script>
    <script src="../../../javascripts/codemirror.js"></script>
    <script src="../../../javascripts/ruby.js"></script>
    <script src="../../../javascripts/matchbrackets.js"></script>
    <script src="../../../javascripts/react_player.js"></script>
    <script src="../../../javascripts/highlight.pack.js"></script>


    <!-- Components are compiled by Hyperloop Express -->
    <script type="text/ruby">

class CodeMirror < Hyperloop::Component
  param :code, type: String
  param :heading, default: "Code"
  param :rows, type: Integer, default: 0
  param :top_level_component, type: String

  before_mount do
    r=rand(2**256).to_s(36)[0..7]
    @div_code = "code_#{r}"
    @div_result = "result_#{r}"
  end

  after_mount do
  # puts params.code
    @editor = `CodeMirror(document.getElementById(#{@div_code}), {
      value: #{params.code.to_s},
      mode: 'text/x-ruby',
      matchBrackets: true,
      lineNumbers: false,
      indentUnit: 2,
      theme: 'github'
    });`

    `#{@editor}.on('change', #{lambda {on_change} })`
    `#{@editor}.setSize(null, #{@editor}.defaultTextHeight()*#{params.rows})` unless params.rows == 0
    execute_code
  end

  render(DIV) do
    div.card {
      div.card_header { params.heading }
      div(id: @div_code)
      div.card_header do
        img(src: '../../../images/hyperloop-logo-small-white.png' , width:'25')
        span { ' ' }
        'Live editor results'
      end
      div.card_block(id: @div_result)
    }
  end

  def on_change
    execute_code
  end

  def execute_code
    begin
      code = `#{@editor}.getValue()`
      # puts code
      code += "\nElement['##{@div_result}'].render(#{params.top_level_component})"
      compiled_code = Opal::Compiler.new(code).compile

      `ReactDOM.unmountComponentAtNode(document.getElementById(#{@div_result}));`

      # Dispatchers and Receivers example works but Steps example breaks
      # Hyperloop::Context.reset!
      # `eval(#{compiled_code})`
      # Hyperloop::Application::Boot.run()

      # Steps example works but Dispatchers and Receivers example breaks
      `eval(#{compiled_code})`
      Hyperloop::Context.reset!
      Hyperloop::Application::Boot.run()

      component = Module.const_get params.top_level_component
      # we need to see if the component is valid - try checking if it can render static markup
      # the following line generates: `undefined method to_n for SimpleComponent`
      # if React.render_to_static_markup( component ).empty?
      #   invalid_component_message
      # end
    rescue Exception => e
      @time_out = after(0.1) do
        unable_to_compile_message e.message
      end
    end
  end

  def invalid_component_message
    message = div.text_danger do
      h3.text_danger {"Oops, invalid Component..."}
      p { "Your Component has been rejected by React. A valid Component must have a render macro and return just one HTML element." }
    end
    Element["##{@div_result}"].render{ message }
  end

  def unable_to_compile_message reason
    message = div.text_danger do
      h3.text_danger {"Can't compile..."}
      p { reason }
    end
    Element["##{@div_result}"].render{ message }
  end

end

</script>

    <script type="text/ruby">

Document.ready? do
   Element.find('div.codemirror-live-edit').each do |mount_point|
     heading = mount_point.attr('data-heading')
     rows = mount_point.attr('data-rows')
     top_level_component = mount_point.attr('data-top-level-component')
     code = Element[mount_point].find('pre').text.strip
     params = {code: code, top_level_component: top_level_component}
     params = params.merge({heading: heading}) if heading
     params = params.merge({rows: rows.to_i}) if rows
     codemirror_component = Object.const_get('CodeMirror')
     React.render(React.create_element(codemirror_component, params ), mount_point)
   end
end

</script>


    <script type="text/ruby">

class ToggleCodemirror < Hyperloop::Component
  param :code, type: String
  param :heading, default: "Code"
  param :rows, type: Integer, default: 0
  param :top_level_component, type: String
  param :show_code

  before_mount do
    r=rand(2**256).to_s(36)[0..7]
    @div_code = "code_#{r}"
    @div_result = "result_#{r}"
  end

  after_mount do
  # puts params.code
    @editor = `CodeMirror(document.getElementById(#{@div_code}), {
      value: #{params.code.to_s},
      mode: 'text/x-ruby',
      matchBrackets: true,
      lineNumbers: false,
      indentUnit: 2,
      readOnly: true,
      theme: 'github'
    });`

    `#{@editor}.setSize(null, #{@editor}.defaultTextHeight()*#{params.rows})` unless params.rows == 0

    Element['.codediv'].hide('')
    mutate.show_code false
    
  end

  render(DIV) do
    div.card {
      div.card_header do
        div(class: 'row') do
          div(class: 'col-md-6') do
            img(src: '../../../images/hyperloop-logo-small-white.png' , width:'25') 
            span { ' ' }
            span { params.heading }
          end
          div(class: 'col-md-6 align-right') do

            toggle_link
          end
        end
      end

      div(id: @div_code, class: 'codediv') 
    }
  end

  def toggle_link
    
      BUTTON(class: 'btn btn-info btn-sm') do
        state.show_code ? "Click to hide code" : "Click to show code"
      end.on(:click) do |ev|
        mutate.show_code !state.show_code 
        state.show_code ? Element["##{@div_code}"].show('') : Element["##{@div_code}"].hide('')
      end
    
  end

 
end

</script>

    <script type="text/ruby">

Document.ready? do
    Element.find('div.togglecode').each do |mount_point|
        heading = mount_point.attr('data-heading')
        rows = mount_point.attr('data-rows')
        top_level_component = mount_point.attr('data-top-level-component')
        code = Element[mount_point].find('pre').text.strip
        params = {code: code, top_level_component: top_level_component}
        params = params.merge({heading: heading}) if heading
        params = params.merge({rows: rows.to_i}) if rows
        codemirror_component = Object.const_get('ToggleCodemirror')
        React.render(React.create_element(codemirror_component, params ), mount_point)
    end
end

</script>

    <link href="../../../stylesheets/bootstrap.min.css" rel="stylesheet" />
    <link href="../../../stylesheets/typography.css" rel="stylesheet" />
    <link href="../../../stylesheets/override.css" rel="stylesheet" />
    <link href="../../../stylesheets/divtable.css" rel="stylesheet" />
    <!-- <link href="../../../stylesheets/code.css" rel="stylesheet" /> -->
    <link href="../../../stylesheets/github.css" rel="stylesheet" />
    <link href="../../../stylesheets/highlighting.css" rel="stylesheet" />
    <link href="../../../stylesheets/codemirror.css" rel="stylesheet" />
    <link href="../../../stylesheets/monokai-sublime.css" rel="stylesheet" />

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <!-- Favicons -->

    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="../../../images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../images/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/images/manifest.json">
    <link rel="mask-icon" href="../../../images/safari-pinned-tab.svg" color="#e81176">
    <meta name="theme-color" content="#ffffff">

  </head>

  <body>
    <div class="navbarbackgroundcolor">
      <div class="container">
        <nav class="navbar navbar-ligh">
  <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2" aria-controls="exCollapsingNavbar2" aria-expanded="false" aria-label="Toggle navigation">
    &#9776;
  </button>
  <div class="collapse navbar-toggleable-xs" id="exCollapsingNavbar2">
    <ul class="nav navbar-nav">
      <li class="nav-item">
        <a href="/" class="nav-link"><span class='navfirstletter'>H</span>yperloop</a>
      </li>
      <li class="nav-item">
        <a href="/start/components" class="nav-link active"><span class='navfirstletter'>S</span>tart</a>
      </li>
      <li class="nav-item">
        <a href="/installation" class="nav-link"><span class='navfirstletter'>I</span>nstallation</a>
      </li>
      <li class="nav-item">
        <a href="/tutorials" class="nav-link"><span class='navfirstletter'>T</span>utorials</a>
      </li>
      <li class="nav-item">
        <a href="/gems" class="nav-link"><span class='navfirstletter'>G</span>ems</a>
      </li>
      <li class="nav-item">
        <a href="https://github.com/ruby-hyperloop" class="nav-link"><span class='navfirstletter'>G</span>ithub</a>
      </li>
      <li class="nav-item">
        <a href="/tools" class="nav-link"><span class='navfirstletter'>T</span>ools</a>
      </li>
      <li class="nav-item">
        <a href="/docs/architecture" class="nav-link"><span class='navfirstletter'>D</span>ocs</a>
      </li>
      <li class="nav-item">
        <a href="/help" class="nav-link"><span class='navfirstletter'>H</span>elp</a>
      </li>
      <li class="nav-item">
        <a href="/blog" class="nav-link"><span class='navfirstletter'>B</span>log</a>
      </li>
      <!-- <li class="nav-item">
        <input type="text" name="search" />
      </li> -->
    </ul>
  </div>
</nav>

      </div>
    </div>





    <div class="jumbotron page-header">
      <div class="container">

        <div class="row hidden-sm-down">
          <div class="col-md-2">
            <div class="hyperlooplogo">
            </div>
          </div>
          <div class="col-md-8">

            <h1 class="display-4 project-name">Hyperloop</h1>

            <h4 class="display-7 project-tagline">

              Tutorials, screencasts & videos
            </h4>
          </div>

        </div>

        <div class="row hidden-md-up">
          <div class="col-md-3">
            <div class="hyperlooplogo">
            </div>
          </div>
          <div class="col-md-9">
            <h1 class="h1 project-name center-text">Hyperloop</h1>
            </br>
            <h2 class="h5 project-tagline center-text">
              Tutorials, screencasts & videos
            </h2>
          </div>

        </div>


      </div>
    </div>

    <div class="page-header-underline">
      <div class="container">

      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-3 sidenavcol">
            <ul class="nav">

    <li class="nav-item"><strong><a href="/tutorials/hyperloopcomps">Hyperloop COMPS</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperloopcomps/compstoreop-first">Simple COMPS App</a></li>
    </ul>
    <br>

    <li class="nav-item"><strong><a href="/tutorials/hyperloopjs">Hyperloop.js</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperloopjs/helloworld">Hello World</a></li>
      <li class="nav-item"><a href="/tutorials/hyperloopjs/chatapp">Chat App</a></li>
    </ul>
    <br>

    <li class="nav-item"><strong><a href="/tutorials/hyperlooprails">Hyperloop and Rails</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperlooprails/helloworld">Hello World</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/todo-tutorial">Todo MVC</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/chatapp">Chat App</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/hyperloop-devise-tutorial">Devise</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/eventsplanner">Events planner</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/fivelettergame">Five letter word game</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/cloud9">Hyperloop and Cloud9</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/webpack">NPM and Webpack</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/hyperloop-rails-webpackergem-helloworld">Webpacker GEM</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/opalhotreloader">Opal Hot Reloader</a></li>
      <li class="nav-item"><a href="/tutorials/hyperlooprails/productionmode">Production mode</a></li>
    </ul>
    <br>

    <li class="nav-item"><strong><a href="/tutorials/hyperloopdeploy">Hyperloop deployment</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperloopdeploy/deployvps">Deploying on VPS</a></li>
      <li class="nav-item"><a href="/tutorials/hyperloopdeploy/deployheroku">Deploying on Heroku</a></li>
    </ul>
    <br>

    <li class="nav-item"><strong><a href="/tutorials/opal">Opal</a></strong></li>
    <br>
    <li class="nav-item"><strong><a href="/tutorials/videos">Videos</a></strong></li>

  </ul>


  <div class="getstarted">
    <br>
    <hr>
    <p>NEWS: RubyHyperloop is to be renamed Hyperstack. Come and see the work-in-progress site: </p>
    <!-- <button type="button" class="btn btn-primary btn-lg btn-hyperlooppink" onclick="https://hyperstack.org';">https://hyperstack.org</button> -->
    <a href='https://hyperstack.org'>https://hyperstack.org</a>
  </div>

          <br>
        </div>
        <div class="col-md-9 main-content">
          <div class="githubhyperloopheader">

<p align="center">

<a href="http://ruby-hyperloop.org/" alt="Hyperloop" title="Hyperloop">
<img width="350px" src="http://ruby-hyperloop.org/images/hyperloop-github-logo.png">
</a>

</p>

<h2 align="center">The Complete Isomorphic Ruby Framework</h2>

<br>

<a href="http://ruby-hyperloop.org/" alt="Hyperloop" title="Hyperloop">
<img src="http://ruby-hyperloop.org/images/githubhyperloopbadge.png">
</a>

<a href="http://ruby-hyperloop.org/tutorials/hyperlooprails/todo-tutorial/" alt="Tutorial page" title="Tutorial page">
<img src="http://ruby-hyperloop.org/images/githubtutorialbadge.png">
</a>

<a href="https://gitter.im/ruby-hyperloop/chat" alt="Gitter chat" title="Gitter chat">
<img src="http://ruby-hyperloop.org/images/githubgitterbadge.png">
</a>

</div>

<h2 id="hyperloop-todomvc-tutorial"><i class="flaticon-professor-teaching"></i><span class="bigfirstletter">H</span>yperloop TodoMVC Tutorial</h2>

<p><img src="http://ruby-hyperloop.org/images/tutorials/Hyperloop-Railstodomvc.gif" alt="Hyperloop railstodomvc" /></p>

<p><img src="http://ruby-hyperloop.org/images/youtube-logo.jpg"> <b>Also follow the TodoMVC screencast:</b></p>

<p><a href="https://www.youtube.com/watch?v=gtL4kAKUt_g" alt="TodoMVC screencast" title="TodoMVC screencast">
<img src="http://ruby-hyperloop.org/images/tutorials/Hyperloop-Railstodomvc-youtube.png">
</a></p>

<h3 id="prerequisites">Prerequisites</h3>

<p>{ <a href="http://rubyonrails.org/">Ruby On Rails</a> }, { <a href="http://ruby-hyperloop.org">hyperloop GEM</a> }</p>

<h3 id="the-goals-of-this-tutorial">The Goals of this Tutorial</h3>

<p>In this tutorial you will build the classic <a href="http://todomvc.com">TodoMVC</a> application using Hyperloop</p>

<p>The finished application will</p>

<ol>
<li>have the ability to add and edit todos;</li>
<li>be able change the complete/incomplete state;</li>
<li>filter the list of displayed todos to show all, complete, or incomplete (active) todos;</li>
<li>have html5 history so that as the filter changes so does the URL;</li>
<li>have server side persistence;</li>
<li>and synchronization across multiple browser windows.</li>
</ol>

<p>You will write less than 100 lines of code, and the tutorial should take about 1-2 hours to complete.</p>

<p>You can find the final application source code here:<br></p>

<p><a href="https://github.com/ruby-hyperloop/todo-tutorial" alt="Tutorial source code" title="Tutorial source code">
<img src="http://ruby-hyperloop.org/images/githubsourcecodebadge.png">
</a></p>

<h3 id="skills-required">Skills required</h3>

<p>Working knowledge of Rails and Hyperloop required</p>

<p><br></p>

<h2 id="tutorial">TUTORIAL</h2>

<h3 id="chapter-1-setting-things-up">Chapter 1: Setting Things Up</h3>

<p>If you do not already have Git, Ruby, Rails, and bundler setup on your development machine then the easiest way to get started doing full stack development with Hyperloop is to use <a href="http://c9.io">Cloud9</a>.  </p>

<p>Even if you are an experienced Rails developer there are some advantages to doing your first experiments on Cloud 9:</p>

<ul>
<li>You will get a consistent setup, which will avoid any possible configuration problems between linux/mac/windows OS versions, etc.</li>
<li>Cloud9 supports co-development, so if you hit a snag it makes it even easier to get help from others.</li>
<li>Your development server can be accessed by others through your unique cloud9 url so you can immediately show people on other machines the Hyperloop multi-client synchronization.</li>
</ul>

<p>Once you are comfortable with Hyperloop, transitioning your app back to your normal development environment is as easy as doing a git pull of your saved repo.</p>

<p><strong>If you want to go ahead and setup hyperloop on your development machine (not using Cloud9) follow these <a href="https://github.com/ruby-hyperloop/rails-clone-and-go">instructions.</a></strong></p>

<p>Otherwise continue for Cloud9 setup:</p>

<p><strong>Step 1: Get a Cloud9 account</strong></p>

<p>Go to Cloud 9&#39;s <a href="http://c9.io">website</a></p>

<p>and signup for an account (you can use your github account for signup.) You will have to supply a credit card, but to our knowledge Cloud9 can be trusted!</p>

<p>Make sure to Connect your Cloud9 account to your github account by going to settings (upper right corner) and clicking the connected services tab, click the connect button next to github and allow it access.</p>

<p><strong>Step 2: Create Your New Workspace</strong></p>

<p>You will be invited to create your first workspace. Cloud9 gives you one private workspace and any number of public workspaces. We recommend you use the public option for your first experiments.</p>

<p>Put &quot;<code>git@github.com:ruby-hyperloop/rails-clone-and-go.git</code>&quot; into the field titled <strong>&quot;Clone from Git or Mercurial URL&quot;</strong>.</p>

<p>Select the &quot;Ruby on Rails&quot; template type, and click the <strong>[Create workspace]</strong> button.</p>

<p><strong>Step 3: Choose Your Branch</strong></p>

<p>The Hyperloop clone and go repo has two branches: <code>master</code> and <code>thin</code>.  If you are running on the default Cloud9 512MB workspace
then you should switch the <code>thin</code> branch before proceeding.  This will use a lot less resources (but will be using polling
instead of ActionCable) for push communications.  To checkout the <code>thin</code> branch run 
<code>bash
git checkout thin
</code>
in the terminal (bash) window.</p>

<p><strong>Step 4: Run the Setup Script</strong></p>

<p>Once your workspace is created you should see a readme displayed. Just follow the directions and run</p>

<p><code>./bin/setup</code> in the terminal window to complete the initialization process.</p>

<p><strong>Make sure you do an <code>rvm use 2.3.1</code> when the script completes!!!</strong></p>

<p><strong>Step 5: Fire Up The Server</strong></p>

<p>On cloud9 use the<br>
  <strong>[Run Project]</strong><br>
command.</p>

<p>If outside of cloud9 in a terminal window run <code>./bin/hyperloop</code></p>

<p><strong>Step 6: Visit the App</strong></p>

<p>On Cloud9 you can see the App running right in the IDE window by clicking on &quot;preview&quot; in the top nav bar, otherwise visit localhost:3000 in your browser.</p>

<p>To see if you have everything setup correctly, find the <code>app/hyperloop/components/app.rb</code> file. In this file, you should be able to recognize the code printing out to the screen.  Try changing the string (and saving) and you should see the change instantly reflected in the browser or IDE preview screen.</p>

<h3 id="chapter-2-hyperloop-models-are-rails-models">Chapter 2:  Hyperloop Models are Rails Models</h3>

<p>We are going to add our Todo Model, and discover that Hyperloop models are in fact Rails models.
+ You can access the your rails models on the client using the same syntax you use on the server.
+ Changes on the client are mirrored on the server.
+ Changes to models on the server are synchronized with all participating browsers.
+ Data access is is protected by a robust <em>policy</em> mechanism.</p>

<blockquote>
<p><em>A Rails ActiveRecord Model is a Ruby class that is backed by a database table.  In this example we will have one model class called <code>Todo</code>.  When manipulating models, Rails automatically generates the necessary SQL code for you.  So when <code>Todo.all</code> is evaluated Rails generates the appropriate SQL
and turns the result of the query into appropriate Ruby data structures.</em></p>

<p><em>Hyperloop Models are extensions of ActiveRecord Models that synchronize the data between the client and server
automatically for you.  So now <code>Todo.all</code> can be evaluated on the server or the client.</em></p>
</blockquote>

<p>Okay lets see it in action:</p>

<ol>
<li><strong>Add the Todo Model:</strong><br>
In the terminal window run <strong>on a single line</strong>:<br></li>
</ol>

<p><code>bundle exec rails g model Todo title:string completed:boolean priority:integer</code>   </p>

<p>This runs a Rails <em>generator</em> which will create the skeleton Todo model class, and create a <em>migration</em> which will
   add the necessary tables and columns to the database.  </p>

<p><strong>VERY IMPORTANT!</strong> Now look in the db/migrate/ directory, and edit the migration file you have just created. The file will be titled with a long string of numbers then &quot;create_todos&quot; at the end. Change the line creating the completed boolean field so that it looks like this:<br>
    <code>ruby  
    ...
        t.boolean :completed, null: false, default: false
    ...
</code><br>
    For details on &#39;why&#39; see <a href="https://robots.thoughtbot.com/avoid-the-threestate-boolean-problem">this blog post.</a>
    Basically this insures <code>completed</code> is treated as a true boolean, and will avoid having to check between <code>false</code> and <code>null</code> later on.   </p>
<pre class="highlight plaintext"><code>Now run `bundle exec rails db:migrate` which will create the table.
</code></pre>
<ol>
<li><strong>Make your Model Public:</strong><br>
<em>Move</em> <code>todo.rb</code> to <code>app/hyperloop/models</code>.<br></li>
</ol>

<p>This will make the model accessible on the clients <em>and the server</em>, subject to any data access policies.  </p>

<p><em>Note: The hyperloop installer adds a policy that gives full permission to all clients but only in development and test modes.  Have a look at <code>app/policies/application_policy</code> if you are interested.</em></p>

<ol>
<li><strong>Try It</strong><br>
Replace the current contents of <code>app/hyperloop/components/app.rb</code> with<br>
<code>ruby
# app/hyperloop/components/app.rb
class App &lt; Hyperloop::Component
 render(DIV) do
   &quot;Number of Todos: #{Todo.count}&quot;
 end
end
</code><br>
<strong>Reload the page</strong> you will see <em>Number of Todos: 0</em> displayed.  <em>You must reload the page as you have changed the class of App from <code>Router</code> to <code>Component</code></em></li>
</ol>

<p>Now start a rails console (enter <code>bundle exec rails c</code> into a new terminal window) and type:<br>
   <code>Todo.create(title: &#39;my first todo&#39;)</code><br>
   this is telling the server to create a new todo, which will update your hyperloop application, and you will see the count change to 1!   </p>

<p>Try it again:<br>
   <code>Todo.create(title: &#39;my second todo&#39;)</code><br>
   and you will see the count change to 2!   </p>

<p>Are we having fun yet?  I hope so!  As you can see Hyperloop is synchronizing the Todo model between the client and server.  As the state of the database changes, HyperReact buzzes around updating whatever parts of the DOM were dependent on that data (in this case the count of Todos).</p>

<p>Notice that we did not create any APIs to achieve this.  Data on the server is synchronized with data on the client for you.</p>

<h3 id="chapter-3-creating-the-top-level-app-structure">Chapter 3: Creating the Top Level App Structure</h3>

<p>Now that we have all of our pieces in place, lets build our application.</p>

<p>Replace the entire contents of <code>app.rb</code> with:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/app.rb</span>
<span class="k">class</span> <span class="nc">App</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">Header</span><span class="p">()</span>
    <span class="no">Index</span><span class="p">()</span>
    <span class="no">Footer</span><span class="p">()</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>The browser screen will go blank because we have not defined the three subcomponents.  Lets define them now:</p>

<p>Add three new ruby files to the <code>app/hyperloop/components</code> folder:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/header.rb</span>
<span class="k">class</span> <span class="nc">Header</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">HEADER</span><span class="p">)</span> <span class="k">do</span>
    <span class="s2">"Header will go here"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre><pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/index.rb</span>
<span class="k">class</span> <span class="nc">Index</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">)</span> <span class="k">do</span>
    <span class="s2">"list of Todos will go here"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre><pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/footer.rb</span>
<span class="k">class</span> <span class="nc">Footer</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">)</span> <span class="k">do</span>
    <span class="s2">"Footer will go here"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Once you add the Footer component you should see:</p>

<p><div style="border:solid; margin-left: 10px; padding: 10px">
    <div>Header will go here</div>
    <div>list of Todos will go here</div><br>
    <div>Footer will go here</div><br>
  </div>
  <br></p>

<p>If you don&#39;t, restart the server, and reload the browser.</p>

<p>Notice how the usual HTML tags such as DIV, SECTION, and HEADER are all available as well as all the other HTML and SVG tags.</p>

<h3 id="chapter-4-listing-the-todos-hyperreact-params-and-prerendering">Chapter 4: Listing the Todos, HyperReact Params, and Prerendering</h3>

<p>To display each Todo we will create a TodoItem component that takes a parameter:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>We can use this component in our Index component:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/index.rb</span>
<span class="k">class</span> <span class="nc">Index</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">UL</span> <span class="k">do</span>
      <span class="no">Todo</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">todo</span><span class="o">|</span>
        <span class="no">TodoItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">todo</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Now you will see something like</p>

<p><div style="border:solid; margin-left: 10px; padding: 10px">
    <div>Header will go here</div>
    <ul>
      <li>my first todo</li>
      <li>my second todo</li>
    </ul>
    <div>Footer will go here</div>
  </div>
  <br></p>

<p>As you can see components can take parameters (or props in react.js terminology.)</p>

<blockquote>
<p><em>Rails uses the terminology params (short for parameters) which have a similar purpose to React props, so to make the transition more natural for Rails programmers Hyperloop uses params, rather than props.</em></p>
</blockquote>

<p>Params are declared using the <code>param</code> macro and are accessed via the <code>params</code> object.
In our case we <em>mount</em> a new TodoItem with each Todo record and pass the Todo as the parameter.   </p>

<p>Now go back to Rails console and type <code>Todo.last.update(title: &#39;updated todo&#39;)</code> and you will see the last Todo in the list changing.</p>

<p>Try adding another Todo using <code>create</code> like you did before.  You will see the new Todo is added to the list.</p>

<h3 id="chapter-5-adding-inputs-to-components">Chapter 5: Adding Inputs to Components</h3>

<p>So far we have seen how our components are synchronized to the data that they display.  Next let&#39;s add the ability for the component to <em>change</em> the underlying data.</p>

<p>First add an <code>INPUT</code> html tag to your TodoItem component like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
    <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Now your display should look like this:
<div style="border:solid; margin-left: 10px; padding: 10px">
  <div>Header will go here</div>
  <ul>
    <li>
      <input type="checkbox" value="on">
      my first todo
    </li>
    <li>
      <input type="checkbox" value="on">
      my second todo
    </li>
  </ul>
  <div>Footer will go here</div>
</div>
<br>
You will notice that while it does display the checkboxes, you can not change them by clicking on them.</p>

<p>For now we can change them via the console like we did before.  Try executing 
<code>Todo.last.update(completed: true)</code><br>
and you should see the last Todo&#39;s <code>completed</code> checkbox changing state.</p>

<p>To make our checkbox input change its own state, we will add an <code>event handler</code> for the click event:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">completed: </span><span class="o">!</span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>It reads like a good novel doesn&#39;t it?  On a <code>click</code> event update the todo, setting the completed attribute to the opposite of its current value.</p>

<p>Meanwhile HyperReact sees the value of <code>params.todo.checked</code> changing, and this causes the associated HTML INPUT tag to be re-rendered.</p>

<p>We will finish up by adding a delete link at the end of the Todo item:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">completed: </span><span class="o">!</span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span> <span class="p">}</span>
    <span class="no">SPAN</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span> <span class="p">}</span> <span class="c1"># See note below...</span>
    <span class="no">A</span> <span class="p">{</span> <span class="s1">' -X-'</span> <span class="p">}.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">destroy</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p><em>Note: If a component or tag block returns a string it is automatically wrapped in a SPAN, to insert a string in the middle you have to wrap it a SPAN like we did above.</em></p>

<p>I hope you are starting to see a pattern here.  HyperReact components determine what to display based on the <code>state</code> of some
objects.  External events, such as mouse clicks, the arrival of new data from the server, and even timers update the <code>state</code>.  HyperReact recomputes whatever portion of the display depends on the <code>state</code> so that the display is always in sync with the <code>state</code>.  In our case the objects are the Todo model and its associated records, which have a number of associated internal <code>states</code>.  </p>

<p>By the way, you don&#39;t have to use Models to have states.  We will see later that states can be as simple as boolean instance variables.</p>

<h3 id="chapter-6-routing">Chapter 6: Routing</h3>

<p>Now that Todos can be <em>completed</em> or <em>active</em>, we would like our user to be able display either &quot;all&quot; Todos,
only &quot;completed&quot; Todos, or &quot;active&quot; (or incomplete) Todos.  We want our URL to reflect which filter is currently being displayed.
So <code>/all</code> will display all todos, <code>/completed</code> will display the completed Todos, and of course <code>/active</code> will display only active
(or incomplete) Todos.  We would also like the root url <code>/</code> to be treated as <code>/all</code></p>

<p>To achieve this we first need to be able to <em>scope</em> (or filter) the Todo Model. So let&#39;s edit the Todo model file so it looks like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/models/todo.rb</span>
<span class="k">class</span> <span class="nc">Todo</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">scope</span> <span class="ss">:completed</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">completed: </span><span class="kp">true</span><span class="p">)</span>  <span class="p">}</span>
  <span class="n">scope</span> <span class="ss">:active</span><span class="p">,</span>    <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">completed: </span><span class="kp">false</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
<p>Now we can say <code>Todo.all</code>, <code>Todo.completed</code>, and <code>Todo.active</code>, and get the desired subset of Todos.
You might want to try it now in the rails console.  <em>Note: you will have to do a <code>reload!</code> to load the changes to the Model.</em></p>

<p>We would like the URL of our App to reflect which of these <em>filters</em> is being displayed.  So if we load</p>

<ul>
<li><code>/all</code> we want the Todo.all scope to be run;</li>
<li><code>/completed</code> we want the Todo.completed scope to be run;</li>
<li><code>/active</code> we want the Todo.active scope to be run;</li>
<li><code>/</code> (by itself) then we should redirect to <code>/all</code>.</li>
</ul>

<p>Having the application display different data (or whole different components) based on the URL is called routing.  </p>

<p>Lets change <code>App</code> to look like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/app.rb</span>
<span class="k">class</span> <span class="nc">App</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span>
  <span class="n">history</span> <span class="ss">:browser</span> 
  <span class="n">route</span> <span class="k">do</span> <span class="c1"># note instead of render we use the route method</span>
    <span class="no">SECTION</span> <span class="k">do</span>
      <span class="no">Header</span><span class="p">()</span>
      <span class="no">Route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="ss">exact: </span><span class="kp">true</span><span class="p">)</span> <span class="p">{</span> <span class="no">Redirect</span><span class="p">(</span><span class="s1">'/all'</span><span class="p">)</span> <span class="p">}</span>
      <span class="no">Route</span><span class="p">(</span><span class="s1">'/:scope'</span><span class="p">,</span> <span class="ss">mounts: </span><span class="no">Index</span><span class="p">)</span>
      <span class="no">Footer</span><span class="p">()</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>and the <code>Index</code> component to look like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/index.rb</span>
<span class="k">class</span> <span class="nc">Index</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">UL</span> <span class="k">do</span>
      <span class="no">Todo</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="nf">params</span><span class="p">[</span><span class="ss">:scope</span><span class="p">]).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">todo</span><span class="o">|</span>
        <span class="no">TodoItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">todo</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p><em>Note that because we have changed the class of these components the hot reloader will break, and you will have to refresh the page.</em></p>

<p>Lets walk through the changes:
+ <code>App</code> now inherits from <code>Hyperloop::Router</code> which is a subclass of <code>Hyperloop::Component</code> with <em>router</em> capabilities added.
+ The <code>history</code> macro tells the router how to track the history (back/forward buttons).<br>
The <code>:browser</code> history tracks the history invisibly in the html5 browser history.
The other common option is the <code>:hash</code> history which tracks the history in the url hash.
+ The <code>render</code> macro is replaced by <code>route</code>, and the <code>DIV</code> tag is moved inside the route block.
+ We mount the <code>Header</code> components as before.
+ We then check to see if the current route exactly matches <code>/</code> and if it does, redirect to <code>/all</code>.
+ Then instead of directly mounting the <code>Index</code> component, we <em>route</em> to it based on the URL.  In this case if the url must look like <code>/xxx</code>.
+ <code>Index</code> now inherits from <code>Hyperloop::Router::Component</code> which is a subclass of <code>Hyperloop::Component</code> with methods like <code>match</code> added.
+ Instead of simply enumerating all the Todos, we decide which <em>scope</em> to filter using the URL fragment <em>matched</em> by <code>:scope</code>.  </p>

<p>Notice the relationship between <code>Route(&#39;/:scope&#39;, mounts: Index)</code> and <code>match.params[:scope]</code>: </p>

<p>During routing each <code>Route</code> is checked.  If it <em>matches</em> then the
indicated component is mounted, and the match parameters are saved for that component to use.</p>

<p>You should now be able to change the url from <code>/all</code>, to <code>/completed</code>, to <code>/active</code>, and see a different set of Todos.  For example if you are displaying the <code>/active</code> Todos, you will only see the Todos that are not complete.  If you check one of these it will disappear from the list.</p>

<blockquote>
<p><em>Rails also has the concept of routing, so how do the Rails and Hyperloop routers interact?  Have a look at the config/routes.rb file.  You will see a line like this:<br>
`  get &#39;/(</em>other)&#39;, to: &#39;hyperloop#app&#39;<code>
This is telling Rails to accept all requests and to process them using the</code>hyperloop<code>controller, which will attempt to mount a component named</code>App` in response to the request.  The mounted App component is then responsible for further processing the URL*  </p>

<p><em>For more complex scenarios Hyperloop provides Rails helper methods that can be used to mount components from your controllers, layouts, and views</em></p>
</blockquote>

<h3 id="chapter-7-helper-methods-inline-styling-active-support-and-router-nav-links">Chapter 7:  Helper Methods, Inline Styling, Active Support and Router Nav Links</h3>

<p>Of course we will want to add navigation to move between these routes.  We will put the navigation in the footer:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/footer.rb</span>
<span class="k">class</span> <span class="nc">Footer</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="k">def</span> <span class="nf">link_item</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="no">A</span><span class="p">(</span><span class="ss">href: </span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">style: </span><span class="p">{</span><span class="ss">marginRight: </span><span class="mi">10</span><span class="p">})</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span>
  <span class="k">end</span>
  <span class="n">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:active</span><span class="p">)</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:completed</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Save the file, and you will now have 3 links, that you will change the path between the three options.  </p>

<p>Here is how the changes work:
+ Hyperloop is just Ruby, so you are free to use all of Ruby&#39;s rich feature set to structure your code. For example the <code>link_item</code> method is just a <em>helper</em> method to save us some typing.
+ The <code>link_item</code> method uses the <code>path</code> argument to construct an HTML <em>Anchor</em> tag.
+ Hyperloop comes with a large portion of the Rails active-support library.  For the text of the anchor tag we use the active-support method <code>camelize</code>.
+ Later we will add proper css classes, but for now we use an inline style.  Notice that the css <code>margin-right</code> is written <code>marginRight</code>, and that <code>10px</code> can be expressed as the integer 10.</p>

<p>Notice that as you click each link the page reloads.  <strong>However</strong> what we really want is for the links to simply change the route, without reloading the page.</p>

<p>To make this happen we will <em>mixin</em> some router helpers by <em>including</em> <code>HyperRouter::ComponentMethods</code> inside of class.</p>

<p>Then we can replace the anchor tag with the Router&#39;s <code>NavLink</code> component:</p>

<p>Change</p>
<pre class="highlight ruby"><code>  <span class="no">A</span><span class="p">(</span><span class="ss">href: </span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">style: </span><span class="p">{</span><span class="ss">marginRight: </span><span class="mi">10</span><span class="p">})</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span>
</code></pre>
<p>to</p>
<pre class="highlight ruby"><code>  <span class="no">NavLink</span><span class="p">(</span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">style: </span><span class="p">{</span><span class="ss">marginRight: </span><span class="mi">10</span><span class="p">})</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span>
</code></pre>
<p>Our component should now look like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/footer.rb</span>
<span class="k">class</span> <span class="nc">Footer</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="kp">include</span> <span class="no">HyperRouter</span><span class="o">::</span><span class="no">ComponentMethods</span>
  <span class="k">def</span> <span class="nf">link_item</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="no">NavLink</span><span class="p">(</span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">style: </span><span class="p">{</span><span class="ss">marginRight: </span><span class="mi">10</span><span class="p">})</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span>
  <span class="k">end</span>
  <span class="n">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:active</span><span class="p">)</span>
    <span class="n">link_item</span><span class="p">(</span><span class="ss">:completed</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>After this change you will notice that changing routes <em>does not</em> reload the page, and after clicking to different routes, you can use the browsers forward and back buttons.</p>

<p>How does it work?  The <code>NavLink</code> component reacts to a click just like an anchor tag, but instead of changing the window&#39;s URL directly, it updates the <em>HTML5 history object.</em>
Associated with this history is a (you guessed it I hope) <em>state</em>.  So when the history changes it causes any components depending on the current URL to be re-rendered.</p>

<h3 id="chapter-8-create-a-basic-edititem-component">Chapter 8: Create a Basic EditItem Component</h3>

<p>So far we can mark Todos as completed, delete them, and filter them.  Now we create an <code>EditItem</code> component so we can change the Todo title.</p>

<p>Add a new component like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/edit_item.rb</span>
<span class="k">class</span> <span class="nc">EditItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">render</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:key_down</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">evt</span><span class="o">|</span>
      <span class="k">next</span> <span class="k">unless</span> <span class="n">evt</span><span class="p">.</span><span class="nf">key_code</span> <span class="o">==</span> <span class="mi">13</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">title: </span><span class="n">evt</span><span class="p">.</span><span class="nf">target</span><span class="p">.</span><span class="nf">value</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Before we use this component let&#39;s understand how it works.
+ It receives a <code>todo</code> param which will be edited by the user;
+ The <code>title</code> of the todo is displayed as the initial value of the input;
+ When the user types the enter key (key code 13) the todo is saved.</p>

<p>Now update the <code>TodoItem</code> component replacing</p>
<pre class="highlight ruby"><code>  <span class="no">SPAN</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span> <span class="p">}</span>
</code></pre>
<p>with</p>
<pre class="highlight ruby"><code>  <span class="no">EditItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">)</span>
</code></pre>
<p>Try it out by changing the text of some our your Todos followed by the enter key.  Then refresh the page to see that the Todos have changed.</p>

<h3 id="chapter-9-adding-state-to-a-component-defining-custom-events-and-a-lifecycle-callback">Chapter 9: Adding State to a Component, Defining Custom Events, and a Lifecycle Callback.</h3>

<p>This all works, but its hard to use.  There is no feed back indicating that a Todo has been saved, and there is no way to cancel after starting to edit.
We can make the user interface much nicer by adding <em>state</em> (there is that word again) to the <code>TodoItem</code>.
We will call our state <code>editing</code>.  If <code>editing</code> is true, then we will display the title in a <code>EditItem</code> component, otherwise we will display it in a <code>LABEL</code> tag.
The user will change the state to <code>editing</code> by double clicking on the label.  When the user saves the Todo, we will change the state of <code>editing</code> back to false.
Finally we will let the user <em>cancel</em> the edit by movig the focus away (the <code>blur</code> event) from the <code>EditItem</code>.
To summarize:
+ User double clicks on any Todo title: editing changes to <code>true</code>.
+ User saves the Todo being edited: editing changes to <code>false</code>.
+ User changes focus away (<code>blur</code>) from the Todo being edited: editing changes to <code>false</code>.
In order to accomplish this our <code>EditItem</code> component is going to communicate via two callbacks - <code>on_save</code> and <code>on_cancel</code> - with the parent component.  We can think of these callbacks as custom events, and indeed as we shall see they will work just like any other event.
Add the following 5 lines to the <code>EditItem</code> component like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/edit_item.rb</span>
<span class="k">class</span> <span class="nc">EditItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">param</span> <span class="ss">:on_save</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>               <span class="c1"># add</span>
  <span class="n">param</span> <span class="ss">:on_cancel</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>             <span class="c1"># add</span>
  <span class="n">after_mount</span> <span class="p">{</span> <span class="no">Element</span><span class="p">[</span><span class="n">dom_node</span><span class="p">].</span><span class="nf">focus</span> <span class="p">}</span>  <span class="c1"># add</span>

  <span class="n">render</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:key_down</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">evt</span><span class="o">|</span>
      <span class="k">next</span> <span class="k">unless</span> <span class="n">evt</span><span class="p">.</span><span class="nf">key_code</span> <span class="o">==</span> <span class="mi">13</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">title: </span><span class="n">evt</span><span class="p">.</span><span class="nf">target</span><span class="p">.</span><span class="nf">value</span><span class="p">)</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">on_save</span>                       <span class="c1"># add</span>
    <span class="k">end</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:blur</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">on_cancel</span> <span class="p">}</span>        <span class="c1"># add</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>The first two lines add our callbacks.  In HyperReact (and React.js) callbacks are just params.
Giving them <code>type: Proc</code> and beginning their name with <code>on_</code> means that HyperReact will treat them syntactically like events (as we will see.)  </p>

<p>The next line uses one of several <em>Lifecycle Callbacks</em>.  In this case we need to move the focus to the <code>EditItem</code> component after is mounted.
The <code>Element</code> class is Hyperloop&#39;s jQuery wrapper, and <code>dom_node</code>
is the method that returns the actual dom node where this instance of the component is mounted.</p>

<p>The <code>params.on_save</code> line will call the provided callback.  Notice that because we declared <code>on_save</code> as type <code>Proc</code>,
when we refer to it in the component it invokes the callback rather than returning the value.
For example, if we had left off <code>type: Proc</code> we would have to say <code>params.on_save.call</code>.</p>

<p>Finally we add the <code>blur</code> event handler and simply transform it into our custom <code>cancel</code> event.</p>

<p>Now we can update our <code>TodoItem</code> component to be a little state machine, which will react to three events:  <code>double_click</code>, <code>save</code> and <code>cancel</code>.</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">state</span> <span class="ss">editing: </span><span class="kp">false</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">state</span><span class="p">.</span><span class="nf">editing</span>
      <span class="no">EditItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">,</span> <span class="ss">:cancel</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">false</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">completed: </span><span class="o">!</span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span> <span class="p">}</span>
      <span class="no">LABEL</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span> <span class="p">}</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:double_click</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">true</span> <span class="p">}</span>
      <span class="no">A</span> <span class="p">{</span> <span class="s1">' -X-'</span> <span class="p">}</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">destroy</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>First we declare a <em>state variable</em> called <code>editing</code> that is initialized to <code>false</code>.</p>

<p>We have already used a lot of states that are built into the HyperModel and HyperRouter.  The state machines in these complex objects are built out of simple state variables like the <code>editing</code>.</p>

<p>State variables are <em>just like instance variables</em> with the added power that when they change, any dependent components will be updated with the change.</p>

<p>You read a state variable using the <code>state</code> method (similar to the <code>params</code> method) and you change state variables using the <code>mutate</code> method.  Whenever you want to change a state variable whether its a simple assignment or changing the internal value of a complex structure like a hash or array you use the <code>mutate</code> method.</p>

<p>Lets read on:  Next we see <code>if state.editing...</code>.  When the component executes this <code>if</code> statement, it reads the value of the <code>editing</code> state variable and will either render the <code>EditItem</code> or the input, label, and anchor tags.  In this way the <code>editing</code> state variable is acting no different than any other Ruby instance variable.  <em>But here is the key:  The component now knows that if the value of the editing state changes, it must re-render this TodoItem.  When state variables are referenced by a component the component will keep track of this, and will re-rerender when the state changes.</em></p>

<p>Because <code>editing</code> starts off false, when the TodoItem first mounts, it renders the input, label, and anchor tags.  Attached to the label tag is a <code>double_click</code> handler which does one thing:  <em>mutates</em> the editing state.  This then causes the component to re-render, and now instead of the three tags, we will render the <code>EditItem</code> component.</p>

<p>Attached to the <code>EditItem</code> component is the <code>save</code> and <code>cancel</code> handler (which is shared between the two events) that <em>mutates</em> the editing state, setting it back to false.</p>

<p>Notice that just as you read params using the <code>params</code> method, you read state variables using the <code>state</code> method.  Note that <code>state</code> is singular because we commonly think of the &#39;state&#39; of an object as singular entity.</p>

<h3 id="chapter-10-using-edititem-to-create-new-todos">Chapter 10: Using EditItem to create new Todos</h3>

<p>Our EditItem component has a good robust interface.  It takes a Todo, and lets the user edit the title, and then either save or cancel, using two event style callbacks to communicate back outwards.</p>

<p>Because of this we can easily reuse EditItem to create new Todos.  Not only does this save us time, but it also insures that the user interface acts consistently.</p>

<p>Update the <code>Header</code> component to use EditItem like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/header.</span>
<span class="k">class</span> <span class="nc">Header</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">state</span><span class="p">(</span><span class="ss">:new_todo</span><span class="p">)</span> <span class="p">{</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="n">render</span><span class="p">(</span><span class="no">HEADER</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">EditItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">state</span><span class="p">.</span><span class="nf">new_todo</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">new_todo</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>What we have done is create a state variable called <code>new_todo</code> and we have initialized it using a block that will return <code>Todo.new</code>.  The reason we use a block is to insure that we don&#39;t call <code>Todo.new</code> until after the system is loaded, at which point all state initialization blocks will be run.  A good rule of thumb is to use the block notation unless the initial value is a constant.</p>

<p>Then we pass the value of the state variable to EditItem, and when it is saved, we generate another new Todo and save it the <code>new_todo</code> state variable.</p>

<p>Notice <code>new_todo</code> is a state variable that is used in Header, so when it is mutated, it will cause a re-render of the Header, which will then pass the new value of <code>new_todo</code>, to EditItem, causing that component to re-render.  </p>

<p>We don&#39;t care if the user cancels the edit, so we simply don&#39;t provide a <code>:cancel</code> event handler.</p>

<p>Once the code is added a new input box will appear at the top of the window, and when you type enter a new Todo will be added to the list.</p>

<p>However you will notice that the value of new Todo input box does not clear.  This is subtle problem that is easy to fix.</p>

<p>React treats the <code>INPUT</code> tags <code>defaultValue</code> specially.  It is only read when the <code>INPUT</code> is first mounted, so it <em>does not react</em> to changes like normal
parameters.  Our <code>Header</code> component does pass in
new Todo records, but even though they are changing React <em>does not</em> update the INPUT.</p>

<p>We can easily fix this by adding a <code>key</code> param to the <code>INPUT</code> that is associated with each unique Todo.
In Ruby this is easy as every object has an <code>object_id</code> method that is guaranteed to return a unique value.</p>

<p>Changing the value of the key, will inform React that we are refering to a new Todo, and thus a  new <code>INPUT</code> element will have to be mounted.</p>
<pre class="highlight ruby"><code><span class="p">.</span><span class="nf">.</span><span class="o">.</span>
    <span class="no">INPUT</span><span class="p">(</span><span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">,</span> <span class="ss">key: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">object_id</span><span class="p">)</span>
<span class="p">.</span><span class="nf">.</span><span class="o">.</span>
</code></pre>
<h3 id="chapter-11-adding-styling">Chapter 11: Adding Styling</h3>

<p>We are just going to steal the style sheet from the benchmark Todo app, and add it to our assets.</p>

<p><strong>Go grab the file in this repo here:</strong> <a href="https://github.com/ruby-hyperloop/todo-tutorial/blob/master/app/assets/stylesheets/todo.css">https://github.com/ruby-hyperloop/todo-tutorial/blob/master/app/assets/stylesheets/todo.css</a>
and copy it to a new file called <code>todo.css</code> in the <code>app/assets/stylesheets/</code> directory.</p>

<p>You will have to refresh the page after changing the style sheet.</p>

<p>Now its a matter of updating the css classes which are passed to components via the <code>class</code> parameter.</p>

<p>Let&#39;s start with the <code>App</code> component.  With styling it will look like this:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/app.rb</span>
<span class="k">class</span> <span class="nc">App</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span>
  <span class="n">history</span> <span class="ss">:browser</span>
  <span class="n">route</span> <span class="k">do</span>
    <span class="no">SECTION</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-app'</span><span class="p">)</span> <span class="k">do</span> <span class="c1"># add the class param</span>
      <span class="no">Header</span><span class="p">()</span>
      <span class="no">Route</span><span class="p">(</span><span class="s1">'/:scope'</span><span class="p">,</span> <span class="ss">mounts: </span><span class="no">Index</span><span class="p">)</span>
      <span class="no">Footer</span><span class="p">()</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>The <code>Footer</code> components needs have a <code>UL</code> added to hold the links nicely,
and we can also use the <code>NavLinks</code> <code>active_class</code> param to highlight the link that is currently active:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/footer.rb</span>
<span class="k">class</span> <span class="nc">Footer</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="kp">include</span> <span class="no">HyperRouter</span><span class="o">::</span><span class="no">ComponentMethods</span>
  <span class="k">def</span> <span class="nf">link_item</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="c1"># wrap the NavLink in a LI and</span>
    <span class="c1"># tell the NavLink to change the class to :selected when </span>
    <span class="c1"># the current (active) path equals the NavLink's path.</span>
    <span class="no">LI</span> <span class="p">{</span> <span class="no">NavLink</span><span class="p">(</span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">active_class: :selected</span><span class="p">)</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span> <span class="p">}</span>
  <span class="k">end</span>
  <span class="n">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">,</span> <span class="ss">class: :footer</span><span class="p">)</span> <span class="k">do</span>   <span class="c1"># add class</span>
    <span class="no">UL</span><span class="p">(</span><span class="ss">class: :filters</span><span class="p">)</span> <span class="k">do</span>         <span class="c1"># wrap links in a UL</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:active</span><span class="p">)</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:completed</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>For the Index component just add the <code>main</code> and <code>todo-list</code> classes.</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/index.rb</span>
<span class="k">class</span> <span class="nc">Index</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">,</span> <span class="ss">class: :main</span><span class="p">)</span> <span class="k">do</span>         <span class="c1"># add class main</span>
    <span class="no">UL</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-list'</span><span class="p">)</span> <span class="k">do</span>              <span class="c1"># add class todo-list</span>
      <span class="no">Todo</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="nf">params</span><span class="p">[</span><span class="ss">:scope</span><span class="p">]).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">todo</span><span class="o">|</span>
        <span class="no">TodoItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">todo</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>For the EditItem component we want the caller specify the class.  To keep things compatible with React.js we need to call the param <code>className</code>,
but we can still send it to EditItem with the usual hyperloop style <code>class</code> param.  </p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/edit_item.rb</span>
<span class="k">class</span> <span class="nc">EditItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">param</span> <span class="ss">:on_save</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>
  <span class="n">param</span> <span class="ss">:on_cancel</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>
  <span class="n">param</span> <span class="ss">:className</span> <span class="c1"># recieves class params</span>
  <span class="n">after_mount</span> <span class="p">{</span> <span class="no">Element</span><span class="p">[</span><span class="n">dom_node</span><span class="p">].</span><span class="nf">focus</span> <span class="p">}</span>
  <span class="n">render</span> <span class="k">do</span>
    <span class="c1"># pass the className param as the INPUT's class</span>
    <span class="no">INPUT</span><span class="p">(</span>
      <span class="ss">class: </span><span class="n">params</span><span class="p">.</span><span class="nf">className</span><span class="p">,</span> 
      <span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">,</span> 
      <span class="ss">key: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">object_id</span>
    <span class="p">).</span><span class="nf">on</span><span class="p">(</span><span class="ss">:key_down</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">evt</span><span class="o">|</span>
      <span class="k">next</span> <span class="k">unless</span> <span class="n">evt</span><span class="p">.</span><span class="nf">key_code</span> <span class="o">==</span> <span class="mi">13</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">save</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">on_save</span>
    <span class="k">end</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:blur</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">on_cancel</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Now we can add classes to the TodoItem&#39;s list-item, input, anchor tags, and to the <code>EditItem</code> component:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">state</span> <span class="ss">editing: </span><span class="kp">false</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">,</span> <span class="ss">class: </span><span class="s1">'todo-item'</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">state</span><span class="p">.</span><span class="nf">editing</span>
      <span class="no">EditItem</span><span class="p">(</span><span class="ss">class: :edit</span><span class="p">,</span> <span class="ss">todo: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">,</span> <span class="ss">:cancel</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">false</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">class: :toggle</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">completed: </span><span class="o">!</span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span> <span class="p">}</span>
      <span class="no">LABEL</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span> <span class="p">}</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:double_click</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">true</span> <span class="p">}</span>
      <span class="no">A</span><span class="p">(</span><span class="ss">class: :destroy</span><span class="p">)</span> <span class="c1"># also remove the { '-X-' } placeholder</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">destroy</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>In the Header we can send a different class to the <code>EditItem</code> component.  While we are at it
we will add the <code>H1 { &#39;todos&#39; }</code> hero unit.</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/header.rb</span>
<span class="k">class</span> <span class="nc">Header</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">state</span><span class="p">(</span><span class="ss">:new_todo</span><span class="p">)</span> <span class="p">{</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="n">render</span><span class="p">(</span><span class="no">HEADER</span><span class="p">,</span> <span class="ss">class: :header</span><span class="p">)</span> <span class="k">do</span>                   <span class="c1"># add the 'header' class</span>
    <span class="no">H1</span> <span class="p">{</span> <span class="s1">'todos'</span> <span class="p">}</span>                                    <span class="c1"># Add the hero unit.</span>
    <span class="no">EditItem</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'new-todo'</span><span class="p">,</span> <span class="ss">todo: </span><span class="n">state</span><span class="p">.</span><span class="nf">new_todo</span><span class="p">)</span> <span class="c1"># add 'new-todo' class</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">new_todo</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>At this point your Todo App should be properly styled.</p>

<h3 id="chapter-12-other-features">Chapter 12: Other Features</h3>

<ul>
<li><strong>Show How Many Items Left In Footer</strong><br>
This is just a span that we add before the link tags list in the Footer component: </li>
</ul>
<pre class="highlight ruby"><code>  <span class="p">.</span><span class="nf">.</span><span class="p">.</span>
  <span class="nf">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">,</span> <span class="ss">class: :footer</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">SPAN</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-count'</span><span class="p">)</span> <span class="k">do</span>
      <span class="s2">"</span><span class="si">#{</span><span class="no">Todo</span><span class="p">.</span><span class="nf">active</span><span class="p">.</span><span class="nf">count</span><span class="si">}</span><span class="s2"> item</span><span class="si">#{</span><span class="s1">'s'</span> <span class="k">if</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">active</span><span class="p">.</span><span class="nf">count</span> <span class="o">!=</span> <span class="mi">1</span><span class="si">}</span><span class="s2"> left"</span>
    <span class="k">end</span>
    <span class="no">UL</span><span class="p">(</span><span class="ss">class: :filters</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">.</span><span class="nf">.</span><span class="o">.</span>
</code></pre>
<ul>
<li><strong>Add &#39;placeholder&#39; Text To Edit Item</strong><br>
EditItem should display a meaningful placeholder hint if the title is blank:<br></li>
</ul>
<pre class="highlight ruby"><code>    <span class="p">.</span><span class="nf">.</span><span class="o">.</span>
    <span class="no">INPUT</span><span class="p">(</span>
      <span class="ss">class: </span><span class="n">params</span><span class="p">.</span><span class="nf">className</span><span class="p">,</span> 
      <span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">,</span>
      <span class="ss">key: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">object_id</span><span class="p">,</span>
      <span class="ss">placeholder: </span><span class="s2">"What is left to do today?"</span>
    <span class="p">).</span><span class="nf">on</span><span class="p">(</span><span class="ss">:key_down</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">evt</span><span class="o">|</span> <span class="p">.</span><span class="nf">.</span><span class="p">.</span>
    <span class="nf">.</span><span class="p">.</span><span class="nf">.</span>
</code></pre>
<ul>
<li><strong>Don&#39;t Show the Footer If There are No Todos</strong><br>
In the <code>App</code> component add a <em>guard</em> so that we won&#39;t show the Footer if there are no Todos:<br></li>
</ul>
<pre class="highlight ruby"><code>  <span class="p">.</span><span class="nf">.</span><span class="o">.</span>
      <span class="no">Footer</span><span class="p">()</span> <span class="k">unless</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">count</span><span class="p">.</span><span class="nf">zero?</span>
  <span class="p">.</span><span class="nf">.</span><span class="o">.</span>
</code></pre>
<p>Congratulations! you have completed the tutorial.</p>

<h3 id="summary">Summary</h3>

<p>You have built a small but feature rich full stack Todo application in less than 100 lines of code:</p>
<pre class="highlight plaintext"><code>SLOC  
--------------  
App:        11  
Header:      8
Index:       9  
TodoItem:   17  
EditItem:   21  
Footer:     16  
Todo Model:  4  
Rails Route: 1  
--------------  
Total:      87  
</code></pre>
<p>The complete application is shown here:</p>
<pre class="highlight ruby"><code><span class="c1"># app/hyperloop/components/app.rb</span>
<span class="k">class</span> <span class="nc">App</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span>
  <span class="n">history</span> <span class="ss">:browser</span> 
  <span class="n">route</span> <span class="k">do</span> <span class="c1"># note instead of render we use the route method</span>
    <span class="no">SECTION</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-app'</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">Header</span><span class="p">()</span>
      <span class="no">Route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="ss">exact: </span><span class="kp">true</span><span class="p">)</span> <span class="p">{</span> <span class="no">Redirect</span><span class="p">(</span><span class="s1">'/all'</span><span class="p">)</span> <span class="p">}</span>
      <span class="no">Route</span><span class="p">(</span><span class="s1">'/:scope'</span><span class="p">,</span> <span class="ss">mounts: </span><span class="no">Index</span><span class="p">)</span>
      <span class="no">Footer</span><span class="p">()</span> <span class="k">unless</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">count</span><span class="p">.</span><span class="nf">zero?</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/components/header.rb</span>
<span class="k">class</span> <span class="nc">Header</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">state</span><span class="p">(</span><span class="ss">:new_todo</span><span class="p">)</span> <span class="p">{</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="n">render</span><span class="p">(</span><span class="no">HEADER</span><span class="p">,</span> <span class="ss">class: :header</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">H1</span> <span class="p">{</span> <span class="s1">'todos'</span> <span class="p">}</span>
    <span class="no">EditItem</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'new-todo'</span><span class="p">,</span> <span class="ss">todo: </span><span class="n">state</span><span class="p">.</span><span class="nf">new_todo</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">new_todo</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">new</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/components/index.rb</span>
<span class="k">class</span> <span class="nc">Index</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Router</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">render</span><span class="p">(</span><span class="no">SECTION</span><span class="p">,</span> <span class="ss">class: :main</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">UL</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-list'</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">Todo</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="nf">params</span><span class="p">[</span><span class="ss">:scope</span><span class="p">]).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">todo</span><span class="o">|</span>
        <span class="no">TodoItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">todo</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/components/footer.rb</span>
<span class="k">class</span> <span class="nc">Footer</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="kp">include</span> <span class="no">HyperRouter</span><span class="o">::</span><span class="no">ComponentMethods</span>
  <span class="k">def</span> <span class="nf">link_item</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="no">LI</span> <span class="p">{</span> <span class="no">NavLink</span><span class="p">(</span><span class="s2">"/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="ss">active_class: :selected</span><span class="p">)</span> <span class="p">{</span> <span class="n">path</span><span class="p">.</span><span class="nf">camelize</span> <span class="p">}</span> <span class="p">}</span>
  <span class="k">end</span>
  <span class="n">render</span><span class="p">(</span><span class="no">DIV</span><span class="p">,</span> <span class="ss">class: :footer</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">SPAN</span><span class="p">(</span><span class="ss">class: </span><span class="s1">'todo-count'</span><span class="p">)</span> <span class="k">do</span>
      <span class="s2">"</span><span class="si">#{</span><span class="no">Todo</span><span class="p">.</span><span class="nf">active</span><span class="p">.</span><span class="nf">count</span><span class="si">}</span><span class="s2"> item</span><span class="si">#{</span><span class="s1">'s'</span> <span class="k">if</span> <span class="no">Todo</span><span class="p">.</span><span class="nf">active</span><span class="p">.</span><span class="nf">count</span> <span class="o">!=</span> <span class="mi">1</span><span class="si">}</span><span class="s2"> left"</span>
    <span class="k">end</span>
    <span class="no">UL</span><span class="p">(</span><span class="ss">class: :filters</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:active</span><span class="p">)</span>
      <span class="n">link_item</span><span class="p">(</span><span class="ss">:completed</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/components/todo_item.rb</span>
<span class="k">class</span> <span class="nc">TodoItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">state</span> <span class="ss">editing: </span><span class="kp">false</span>
  <span class="n">render</span><span class="p">(</span><span class="no">LI</span><span class="p">,</span> <span class="ss">class: </span><span class="s1">'todo-item'</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">state</span><span class="p">.</span><span class="nf">editing</span>
      <span class="no">EditItem</span><span class="p">(</span><span class="ss">todo: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">,</span> <span class="ss">class: :edit</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:save</span><span class="p">,</span> <span class="ss">:cancel</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">false</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="no">INPUT</span><span class="p">(</span><span class="ss">type: :checkbox</span><span class="p">,</span> <span class="ss">class: :toggle</span><span class="p">,</span> <span class="ss">checked: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">completed: </span><span class="o">!</span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">completed</span><span class="p">)</span> <span class="p">}</span>
      <span class="no">LABEL</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span> <span class="p">}</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:double_click</span><span class="p">)</span> <span class="p">{</span> <span class="n">mutate</span><span class="p">.</span><span class="nf">editing</span> <span class="kp">true</span> <span class="p">}</span>
      <span class="no">A</span><span class="p">(</span><span class="ss">class: :destroy</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:click</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">destroy</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/components/edit_item.rb</span>
<span class="k">class</span> <span class="nc">EditItem</span> <span class="o">&lt;</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Component</span>
  <span class="n">param</span> <span class="ss">:todo</span>
  <span class="n">param</span> <span class="ss">:on_save</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>               
  <span class="n">param</span> <span class="ss">:on_cancel</span><span class="p">,</span> <span class="ss">type: </span><span class="no">Proc</span>             
  <span class="n">param</span> <span class="ss">:className</span>
  <span class="n">after_mount</span> <span class="p">{</span> <span class="no">Element</span><span class="p">[</span><span class="n">dom_node</span><span class="p">].</span><span class="nf">focus</span> <span class="p">}</span>  

  <span class="n">render</span> <span class="k">do</span>
    <span class="no">INPUT</span><span class="p">(</span>
      <span class="ss">class: </span><span class="n">params</span><span class="p">.</span><span class="nf">className</span><span class="p">,</span> 
      <span class="ss">defaultValue: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">title</span><span class="p">,</span>
      <span class="ss">key: </span><span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">object_id</span><span class="p">,</span>
      <span class="ss">placeholder: </span><span class="s2">"What is left to do today?"</span>
    <span class="p">).</span><span class="nf">on</span><span class="p">(</span><span class="ss">:key_down</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">evt</span><span class="o">|</span>
      <span class="k">next</span> <span class="k">unless</span> <span class="n">evt</span><span class="p">.</span><span class="nf">key_code</span> <span class="o">==</span> <span class="mi">13</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">todo</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="ss">title: </span><span class="n">evt</span><span class="p">.</span><span class="nf">target</span><span class="p">.</span><span class="nf">value</span><span class="p">)</span>
      <span class="n">params</span><span class="p">.</span><span class="nf">on_save</span>                       
    <span class="k">end</span>
    <span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="ss">:blur</span><span class="p">)</span> <span class="p">{</span> <span class="n">params</span><span class="p">.</span><span class="nf">on_cancel</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/hyperloop/models/todo.rb</span>
<span class="k">class</span> <span class="nc">Todo</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">scope</span> <span class="ss">:completed</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">completed: </span><span class="kp">true</span><span class="p">)</span>  <span class="p">}</span>
  <span class="n">scope</span> <span class="ss">:active</span><span class="p">,</span>    <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">completed: </span><span class="kp">false</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>

<span class="c1"># config/routes.rb</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">mount</span> <span class="no">Hyperloop</span><span class="o">::</span><span class="no">Engine</span> <span class="o">=&gt;</span> <span class="s1">'/hyperloop'</span>
  <span class="n">get</span> <span class="s1">'/(*other)'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'hyperloop#app'</span> <span class="c1"># route everything to the App component</span>
<span class="k">end</span>
</code></pre>
<h3 id="general-troubleshooting">General troubleshooting</h3>

<p>1: Wait. On initial boot it can take several minutes to pre-compile all the system assets.  </p>

<p>2: Make sure to save (or better yet do a git commit) after every instruction so that you can backtrack</p>

<p>3: Its possible to get things so messed up the hot-reloader will not work.  Restart the server and reload the browser.</p>

<p><hr></p>

<p>You can find the final application source code here:<br></p>

<p><a href="https://github.com/ruby-hyperloop/hyperloop-rails-webpackergem-helloworld" alt="Tutorial source code" title="Tutorial source code">
<img src="http://ruby-hyperloop.org/images/githubsourcecodebadge.png">
</a></p>

<p><br><br></p>

<p>The best way to get help and contribute is to join our Gitter Chat</p>

<p><a href="https://gitter.im/ruby-hyperloop/chat" alt="Gitter chat" title="Gitter chat">
<img src="http://ruby-hyperloop.org/images/githubgitterbadge.png">
</a></p>

<p></div></p>

        </div>
      </div>
    </div>

    <div class="page-footer-upperline">
      <div class="container">

      </div>
    </div>

    <footer class="nav-footer">
  <section class="sitemap">

    <a href="/" class="nav-home"></a>

    <div>
      <h6><a href="/start/components" class="hyperloop-white">Start</a></h6>
      <a href="/start/components">Components</a>
      <a href="/start/stores">Stores</a>
      <a href="/start/models">Models</a>
      <a href="/start/operations">Operations</a>
      <a href="/start/policies">Policies</a>
      <a href="/start/pragmatic">Pragmatic Thinking</a>
    </div>
    <div>


      <h6><a href="/tutorials" class="hyperloop-white">Tutorials</a></h6>
      <a href="/tutorials/hyperloopcomps">Hyperloop COMPS</a>
      <a href="/tutorials/hyperloopjs">Hyperloop.js</a>
      <a href="/tutorials/hyperlooprails">Hyperloop and Rails</a>
      <a href="/tutorials/hyperloopdeploy">Hyperloop deployment</a>
      <a href="/tutorials/opal">Opal</a>
      <a href="/tutorials/videos">Videos</a>
    </div>
    <div>
      <h6><a href="/installation" class="hyperloop-white">Installation</a></h6>
      <a href="/installation#opal-playground">Hyperloop.js</a>
  	  <a href="/installation#ror">With Ruby On Rails</a>
  	  <a href="/installation#with-sinatra">With Sinatra</a>
  	  <a href="/installation#deployment">Deployment</a>
    </div>
    <div>
      <h6><a href="/gems" class="hyperloop-white">Gems</a></h6>
      <a href="https://github.com/ruby-hyperloop/hyperloop">hyperloop</a>
      <a href="https://github.com/ruby-hyperloop/hyperloop-js">hyperloop-js</a>
      <a href="https://github.com/ruby-hyperloop/hyper-react">hyper-component</a>
      <a href="https://github.com/ruby-hyperloop/hyper-store">hyper-store</a>
      <a href="https://github.com/ruby-hyperloop/hyper-mesh">hyper-model</a>
      <a href="https://github.com/ruby-hyperloop/hyper-operation">hyper-operation</a>
      <a href="https://github.com/ruby-hyperloop/reactrb-router/tree/v2-4-0">hyper-router</a>
      <a href="https://github.com/ruby-hyperloop/hyper-spec">hyper-spec</a>
      <a href="https://github.com/ruby-hyperloop/hyper-trace">hyper-trace</a>
    </div>
    <div>
      <h6><a href="/tools" class="hyperloop-white">Tools</a></h6>
      <a href="#testing">Testing</a>
    	<a href="#tools">Tools</a>
    	<a href="#debugging">Debugging</a>
    </div>
    <div>
      <h6><a href="/docs/architecture" class="hyperloop-white">Docs</a></h6>
      <a href="/docs/architecture">Architecture</a>
      <a href="/docs/components/docs#components-dsl-overview">Components</a>
      <a href="/docs/stores/docs">Stores</a>
      <a href="/docs/models/docs">Models</a>
      <a href="/docs/operations/docs">Operations</a>
      <a href="/docs/policies/docs">Policies</a>
    </div>

  </section>

  <section class="otherlinks">
    <a href="https://github.com/ruby-hyperloop" class="hyperloop-white">Github</a>
    <a href="/support" class="hyperloop-white">Help</a>
    <a href="/blog" class="hyperloop-white">Blog</a>
  </section>

  <section class="copyright">
    Copyright © 2018 Hyperloop.
  </section>
</footer>


    <script>
      (function(Opal) {
        var self = Opal.top, $scope = Opal, nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;
        Opal.add_stubs(['$puts']);
        return self.$puts("Opal ok")
      })(Opal);
    </script>

    <!-- <script   src="http://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script> -->


    <script type="text/ruby">puts "Hyperloop JS ok"</script>




  </body>
</html>
